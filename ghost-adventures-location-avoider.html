<!doctype html>
<html lang="en" data-theme="system">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ghost Adventures — Location Avoider</title>
  <style>
    /*
      Theme model:
      - data-theme="system" uses prefers-color-scheme
      - data-theme="light" forces light
      - data-theme="dark" forces dark
    */
    html { color-scheme: light dark; }
    html[data-theme="light"] { color-scheme: light; }
    html[data-theme="dark"] { color-scheme: dark; }

    :root {
      --bg: #ffffff;
      --fg: #111111;
      --card: #ffffff;
      --border: rgba(0,0,0,.15);
      --border2: rgba(0,0,0,.10);
      --muted: rgba(0,0,0,.68);
      --muted2: rgba(0,0,0,.55);
      --focus: rgba(0, 120, 215, .9);
      --focusShadow: rgba(0, 120, 215, .15);
    }

    @media (prefers-color-scheme: dark) {
      html[data-theme="system"]:root,
      :root {
        --bg: #0b0b0c;
        --fg: #f5f5f7;
        --card: #111114;
        --border: rgba(255,255,255,.18);
        --border2: rgba(255,255,255,.12);
        --muted: rgba(245,245,247,.75);
        --muted2: rgba(245,245,247,.60);
      }
    }

    html[data-theme="light"]:root {
      --bg: #ffffff;
      --fg: #111111;
      --card: #ffffff;
      --border: rgba(0,0,0,.15);
      --border2: rgba(0,0,0,.10);
      --muted: rgba(0,0,0,.68);
      --muted2: rgba(0,0,0,.55);
    }

    html[data-theme="dark"]:root {
      --bg: #0b0b0c;
      --fg: #f5f5f7;
      --card: #111114;
      --border: rgba(255,255,255,.18);
      --border2: rgba(255,255,255,.12);
      --muted: rgba(245,245,247,.75);
      --muted2: rgba(245,245,247,.60);
    }

    * { box-sizing: border-box; }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.35;
      background: var(--bg);
      color: var(--fg);
    }

    header {
      padding: 16px 18px;
      text-align: center;
      border-bottom: 1px solid var(--border);
      position: sticky;
      top: 0;
      background: var(--bg);
      z-index: 10;
    }

    h1 { margin: 0 0 6px; font-size: 18px; }
    .sub { margin: 0; opacity: .9; color: var(--muted); font-size: 13px; }

    .header-actions {
      position: absolute;
      right: 18px;
      top: 14px;
      display: flex;
      gap: 8px;
      align-items: center;
      justify-content: flex-end;
    }

    .header-actions button {
      padding: 8px 10px;
      border-radius: 10px;
      font-size: 12px;
    }

    @media (max-width: 520px) {
      .header-actions { position: static; margin-top: 10px; justify-content: center; }
    }

    main { padding: 16px 18px 28px; max-width: 1100px; margin: 0 auto; }

    .controls {
      display: grid;
      grid-template-columns: 1.2fr .9fr .9fr auto;
      gap: 10px;
      align-items: end;
      margin-bottom: 12px;
    }

    label { display: block; font-size: 12px; color: var(--muted); margin-bottom: 6px; }

    input[type="text"], select, textarea {
      width: 100%;
      padding: 10px 11px;
      border: 1px solid var(--border);
      border-radius: 10px;
      background: var(--card);
      color: var(--fg);
      outline: none;
    }

    input[type="text"]::placeholder, textarea::placeholder { color: var(--muted2); }

    input[type="text"]:focus, select:focus, textarea:focus {
      border-color: var(--focus);
      box-shadow: 0 0 0 3px var(--focusShadow);
    }

    button {
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 10px;
      background: var(--card);
      color: var(--fg);
      cursor: pointer;
      white-space: nowrap;
    }

    button[disabled] { opacity: .6; cursor: not-allowed; }
    button:hover { filter: brightness(1.05); }
    button:active { transform: translateY(1px); }

    .row {
      display: grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 12px;
      align-items: start;
      margin-top: 14px;
    }

    .card {
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
      background: var(--card);
    }

    .meta {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      align-items: center;
      margin: 8px 0 0;
      font-size: 12px;
      color: var(--muted);
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    th, td {
      text-align: left;
      padding: 10px 8px;
      border-bottom: 1px solid var(--border2);
      vertical-align: top;
      font-size: 13px;
    }

    th { position: sticky; top: 0; background: var(--card); z-index: 5; }

    .pill {
      display: inline-flex;
      gap: 6px;
      align-items: center;
      padding: 3px 8px;
      border: 1px solid var(--border);
      border-radius: 999px;
      font-size: 12px;
      color: var(--muted);
      background: transparent;
    }

    .muted { color: var(--muted); }
    .nowrap { white-space: nowrap; }

    .toolbar {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 10px;
      align-items: center;
    }

    .avoid-list {
      display: grid;
      gap: 10px;
    }

    .avoid-actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-top: 10px;
    }

    .small {
      font-size: 12px;
      color: var(--muted);
    }

    .banner-error {
      margin-top: 10px;
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: transparent;
      color: var(--muted);
      font-size: 12px;
    }

    @media (max-width: 900px) {
      .controls { grid-template-columns: 1fr 1fr; }
      .controls .full { grid-column: 1 / -1; }
      .row { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Ghost Adventures — Location Avoider</h1>
    <p class="sub">Search the investigation locations list (from the dataset gathered in this chat) and build a personal “avoid staying here” list for holidays.</p>
    <div class="header-actions">
      <button id="themeBtn" type="button" title="Toggle theme">Theme: System</button>
    </div>
  </header>

  <main>
    <section class="controls">
      <div class="full">
        <label for="q">Search (city, site, country, state/region)</label>
        <input id="q" type="text" placeholder="e.g., ‘Edinburgh’, ‘Catacombs’, ‘Nevada’, ‘Waverly’" autocomplete="off" />
      </div>

      <div>
        <label for="country">Country</label>
        <select id="country"></select>
      </div>

      <div>
        <label for="state">State / Region</label>
        <select id="state"></select>
      </div>

      <div>
        <button id="clear" title="Clear search & filters">Clear</button>
      </div>
    </section>

    <section class="toolbar">
      <span class="pill"><strong id="matchCount">0</strong> matches</span>
      <span class="pill"><strong id="totalCount">0</strong> locations</span>
      <label class="pill" style="cursor:pointer;">
        <input id="exact" type="checkbox" style="margin:0 6px 0 0;"> Exact-ish match
      </label>
      <span class="small">Tip: “Exact-ish” requires full-word matches (good for city names).</span>
    </section>

    <div id="errorBanner" class="banner-error" style="display:none;"></div>

    <div class="row">
      <section class="card" aria-label="Results">
        <div class="muted" style="margin-bottom:10px; font-size:12px;">
          Click <span class="nowrap">“Avoid”</span> to add an entry to your holiday avoid list.
        </div>
        <div style="max-height: 62vh; overflow:auto; border-radius: 10px;">
          <table>
            <thead>
              <tr>
                <th style="width: 20%;">Country</th>
                <th style="width: 18%;">State/Region</th>
                <th style="width: 18%;">City/Town</th>
                <th>Site</th>
                <th style="width: 90px;"></th>
              </tr>
            </thead>
            <tbody id="results"></tbody>
          </table>
        </div>
      </section>

      <aside class="card" aria-label="Avoid list">
        <h2 style="margin:0 0 8px; font-size:16px;">My avoid list</h2>
        <p class="small" style="margin:0 0 10px;">Use this as a quick “don’t-book-here” checklist when planning travel.</p>

        <div class="avoid-list">
          <textarea id="avoidText" rows="10" placeholder="Your avoided places will appear here…"></textarea>
          <div class="avoid-actions">
            <button id="copy">Copy</button>
            <button id="download">Download CSV</button>
            <button id="resetAvoid">Reset</button>
          </div>
          <div class="small">
            The avoid list is stored in your browser (localStorage) so it persists if you reopen this file.
          </div>
        </div>
      </aside>
    </div>

    <section class="card" style="margin-top: 14px;">
      <h2 style="margin:0 0 8px; font-size:16px;">Check a destination quickly</h2>
      <div class="controls" style="grid-template-columns: 1.2fr auto; margin: 0;">
        <div>
          <label for="check">Destination you’re considering</label>
          <input id="check" type="text" placeholder="e.g., ‘Las Vegas’, ‘Jerome Grand Hotel’, ‘Wexford’" />
        </div>
        <div>
          <button id="runCheck">Check</button>
        </div>
      </div>
      <div id="checkOut" class="meta"></div>
    </section>

    <p class="small" style="margin-top: 14px;">
      Data note: this list is based on the locations gathered earlier in this chat (derived from the episode/special “Location(s)” field). It may include duplicates (revisits/recaps) and occasional formatting quirks from the source.
    </p>
  </main>

  <script>
    // =========================
    // DATA
    // Format: [country, stateOrRegion, cityOrTown, site]
    // =========================
    const RAW = [
      ["Canada","Ontario","Fort Erie","Olde Fort Erie"],
      ["France","Ile-de-France","Paris","Paris Catacombs"],
      ["Ireland","County Dublin","Montpelier Hill","Ireland's Celtic Demons"],
      ["Ireland","County Offaly","Clareen","Ireland's Celtic Demons"],
      ["Ireland","County Wexford","Duncannon","Ireland's Celtic Demons"],
      ["Italy","Veneto","Venice","Poveglia Island (special)"],
      ["Jamaica","St. James Parish","Montego Bay","Rose Hall"],
      ["Mexico","Mexico City","Xochimilco","Island of the Dolls"],
      ["Romania","Cluj","Cluj-Napoca","Dracula's Castle (special)"],
      ["Romania","Dâmbovița","Târgoviște","Dracula's Castle (special)"],
      ["Romania","Hunedoara","Hunedoara","Dracula's Castle (special)"],
      ["United Kingdom","England","Gillingham","Ancient Ram Inn"],
      ["United Kingdom","England","West Wycombe","Hellfire Caves"],
      ["United Kingdom","England","Wotton-under-Edge","Ancient Ram Inn"],
      ["United Kingdom","Kent","Chatham","Fort Horsted"],
      ["United Kingdom","Scotland","Edinburgh","Edinburgh Vaults"],

      // United States (partial list placeholder)
      ["United States","Alabama","Birmingham","Sloss Furnaces"],
      ["United States","Arizona","Apache Junction","Apache Junction"],
      ["United States","Arizona","Bisbee","Bird Cage Theatre"],
      ["United States","Arizona","Casa Grande","Casa Grande Domes"],
      ["United States","Arizona","Flagstaff","Fear in Flagstaff"],
      ["United States","Arizona","Jerome","Jerome Grand Hotel"],
      ["United States","Arizona","Prescott","Palace Saloon"],
      ["United States","Arizona","Tombstone","Bird Cage Theatre"],
      ["United States","Arizona","Yuma","Yuma Territorial Prison"],
      ["United States","Arkansas","Eureka Springs","Crescent Hotel"],

      ["United States","California","Alameda","USS Hornet"],
      ["United States","California","Bodie","Bodie"],
      ["United States","California","Ione","Preston Castle"],
      ["United States","California","Keeler","Cerro Gordo Ghost Town"],
      ["United States","California","Los Angeles","Cecil Hotel"],
      ["United States","California","Los Angeles","Hotel Barclay"],
      ["United States","California","Napa","Napa State Mental Hospital"],
      ["United States","California","San Francisco","Alcatraz"],
      ["United States","California","Vallejo","Mare Island Naval Shipyard"],

      ["United States","Colorado","Estes Park","Stanley Hotel"],
      ["United States","Connecticut","Hartford","Union Cemetery"],
      ["United States","Florida","St. Augustine","Castillo de San Marcos"],
      ["United States","Georgia","Savannah","Moon River Brewing Company"],
      ["United States","Idaho","Boise","Old Idaho Penitentiary"],
      ["United States","Illinois","Ashmore","Ashmore Estates"],
      ["United States","Kentucky","Louisville","Waverly Hills Sanatorium"],
      ["United States","Massachusetts","Salem","Salem Witch House"],
      ["United States","Minnesota","Duluth","Nopeming Sanatorium"],

      ["United States","Nevada","Las Vegas","Zak Bagans' The Haunted Museum"],
      ["United States","Nevada","Goodsprings","Pioneer Saloon"],
      ["United States","Nevada","Virginia City","Washoe Club"],

      // Oregon
      ["United States","Oregon","Astoria","Fort Stevens"],
      ["United States","Oregon","Golden","Golden Ghost Town"],
      ["United States","Oregon","Wolf Creek","Wolf Creek Inn"],
      ["United States","Oregon","Pendleton","Buried Souls of Pendleton"],

      ["United States","Pennsylvania","Philadelphia","Eastern State Penitentiary"],
      ["United States","Tennessee","Memphis","Graceland"],
      ["United States","Utah","Tooele","Asylum 49"],
      ["United States","Washington","Seattle","Kell's Irish Pub"],
      ["United States","West Virginia","Moundsville","West Virginia State Penitentiary"],
      ["United States","Wyoming","Rawlins","Wyoming Frontier Prison"],

      // Recap buckets
      ["Various Locations","—","Various","Armies of Darkness (recap)"],
      ["Various Locations","—","Various","First Timers (recap)"],
      ["Various Locations","—","Various","Killer Nightlife (recap)"],
      ["Various Locations","—","Various","Wickedest Women / Houses of Terror / Bloodiest Battlefields (recap)"],
    ];

    // =========================
    // HELPERS
    // =========================
    const norm = (s) => (s ?? "").toString().trim().toLowerCase();
    const words = (s) => norm(s).split(/[^a-z0-9]+/).filter(Boolean);

    function escapeHtml(s) {
      return String(s).replace(/[&<>"']/g, (c) => ({
        "&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"
      }[c]));
    }

    function toCSV(rows) {
      const esc = (v) => {
        const s = String(v ?? "");
        return /[\n\r,\"]/g.test(s) ? '"' + s.replaceAll('"','""') + '"' : s;
      };
      return [
        ["country","state_region","city_town","site"].join(","),
        ...rows.map(r => [r.country, r.state, r.city, r.site].map(esc).join(","))
      ].join("\n");
    }

    function download(filename, text) {
      const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = filename;
      document.body.appendChild(a);
      a.click();
      a.remove();
      setTimeout(() => URL.revokeObjectURL(url), 1000);
    }

    // =========================
    // DATA NORMALIZATION + DEDUPE
    // =========================
    const ALL = (() => {
      const seen = new Set();
      const out = [];
      for (const [country, state, city, site] of RAW) {
        const obj = {
          country: country || "—",
          state: state || "—",
          city: city || "—",
          site: site || "—",
        };
        const key = [obj.country, obj.state, obj.city, obj.site].map(norm).join("|");
        if (seen.has(key)) continue;
        seen.add(key);
        out.push(obj);
      }
      out.sort((a,b) =>
        a.country.localeCompare(b.country) ||
        a.state.localeCompare(b.state) ||
        a.city.localeCompare(b.city) ||
        a.site.localeCompare(b.site)
      );
      return out;
    })();

    // =========================
    // UI STATE
    // =========================
    const els = {
      q: document.getElementById("q"),
      country: document.getElementById("country"),
      state: document.getElementById("state"),
      exact: document.getElementById("exact"),
      clear: document.getElementById("clear"),
      results: document.getElementById("results"),
      matchCount: document.getElementById("matchCount"),
      totalCount: document.getElementById("totalCount"),
      avoidText: document.getElementById("avoidText"),
      copy: document.getElementById("copy"),
      download: document.getElementById("download"),
      resetAvoid: document.getElementById("resetAvoid"),
      check: document.getElementById("check"),
      runCheck: document.getElementById("runCheck"),
      checkOut: document.getElementById("checkOut"),
      themeBtn: document.getElementById("themeBtn"),
      errorBanner: document.getElementById("errorBanner"),
    };

    // =========================
    // THEME
    // =========================
    const THEME_KEY = "ga_theme_v1";
    const THEME_ORDER = ["system", "light", "dark"]; // cycles

    function setTheme(theme) {
      const t = THEME_ORDER.includes(theme) ? theme : "system";
      document.documentElement.setAttribute("data-theme", t);
      els.themeBtn.textContent = `Theme: ${t[0].toUpperCase()}${t.slice(1)}`;
      try { localStorage.setItem(THEME_KEY, t); } catch {}
    }

    function getTheme() {
      try {
        const t = localStorage.getItem(THEME_KEY);
        return THEME_ORDER.includes(t) ? t : "system";
      } catch {
        return "system";
      }
    }

    function nextTheme(current) {
      const idx = Math.max(0, THEME_ORDER.indexOf(current));
      return THEME_ORDER[(idx + 1) % THEME_ORDER.length];
    }

    // =========================
    // AVOID LIST
    // =========================
    const AVOID_KEY = "ga_avoid_list_v1";

    const loadAvoid = () => {
      try {
        const raw = localStorage.getItem(AVOID_KEY);
        const arr = raw ? JSON.parse(raw) : [];
        return Array.isArray(arr) ? arr : [];
      } catch { return []; }
    };

    const saveAvoid = (arr) => {
      try { localStorage.setItem(AVOID_KEY, JSON.stringify(arr)); } catch {}
    };

    let avoid = loadAvoid();

    function avoidKey(r) {
      return [r.country, r.state, r.city, r.site].map(norm).join("|");
    }

    function avoidToText(arr) {
      return arr
        .slice()
        .sort((a,b) =>
          a.country.localeCompare(b.country) ||
          a.state.localeCompare(b.state) ||
          a.city.localeCompare(b.city) ||
          a.site.localeCompare(b.site)
        )
        .map(r => `${r.city} — ${r.site} (${r.state}, ${r.country})`)
        .join("\n");
    }

    function renderAvoid() {
      els.avoidText.value = avoidToText(avoid);
      saveAvoid(avoid);
    }

    // =========================
    // FILTER DROPDOWNS
    // =========================
    function fillCountries() {
      const countries = Array.from(new Set(ALL.map(r => r.country)))
        .sort((a,b)=>a.localeCompare(b));

      els.country.innerHTML = [
        `<option value="">All countries</option>`,
        ...countries.map(c => `<option value="${escapeHtml(c)}">${escapeHtml(c)}</option>`)
      ].join("");
    }

    function fillStates(country) {
      const states = Array.from(new Set(
        ALL
          .filter(r => !country || r.country === country)
          .map(r => r.state)
      )).sort((a,b)=>a.localeCompare(b));

      els.state.innerHTML = [
        `<option value="">All states/regions</option>`,
        ...states.map(s => `<option value="${escapeHtml(s)}">${escapeHtml(s)}</option>`)
      ].join("");
    }

    // =========================
    // SEARCH
    // =========================
    function matchesRow(row, query, exact) {
      if (!query) return true;
      const hay = `${row.country} ${row.state} ${row.city} ${row.site}`;
      if (!exact) return norm(hay).includes(norm(query));

      const qTokens = words(query);
      if (!qTokens.length) return true;
      const hTokens = new Set(words(hay));
      return qTokens.every(t => hTokens.has(t));
    }

    function filterRows() {
      const q = els.q.value.trim();
      const country = els.country.value || "";
      const state = els.state.value || "";
      const exact = els.exact.checked;

      return ALL.filter(r => {
        if (country && r.country !== country) return false;
        if (state && r.state !== state) return false;
        return matchesRow(r, q, exact);
      });
    }

    function renderResults() {
      const rows = filterRows();
      els.matchCount.textContent = String(rows.length);

      const avoidSet = new Set(avoid.map(avoidKey));

      els.results.innerHTML = rows.map(r => {
        const key = avoidKey(r);
        const inAvoid = avoidSet.has(key);
        return `
          <tr>
            <td>${escapeHtml(r.country)}</td>
            <td>${escapeHtml(r.state)}</td>
            <td>${escapeHtml(r.city)}</td>
            <td>${escapeHtml(r.site)}</td>
            <td class="nowrap">
              <button data-action="avoid" data-key="${escapeHtml(key)}" ${inAvoid ? "disabled" : ""}>
                ${inAvoid ? "Avoided" : "Avoid"}
              </button>
            </td>
          </tr>
        `;
      }).join("");
    }

    function addToAvoidByKey(key) {
      const row = ALL.find(r => avoidKey(r) === key);
      if (!row) return;
      if (avoid.some(a => avoidKey(a) === key)) return;
      avoid.push(row);
      renderAvoid();
      renderResults();
    }

    // =========================
    // DESTINATION CHECKER
    // =========================
    function runDestinationCheck() {
      const q = els.check.value.trim();
      els.checkOut.innerHTML = "";
      if (!q) return;

      const hits = ALL.filter(r => matchesRow(r, q, true));

      if (!hits.length) {
        els.checkOut.innerHTML = `<span class="pill">No exact-ish match found</span><span class="small">Try fewer words (e.g., just the city) or turn off “Exact-ish” in the main search.</span>`;
        return;
      }

      const maxShow = 8;
      const shown = hits.slice(0, maxShow);

      els.checkOut.innerHTML = `
        <span class="pill"><strong>${hits.length}</strong> match${hits.length === 1 ? "" : "es"}</span>
        ${shown.map(r => `<span class="pill">${escapeHtml(r.city)} — ${escapeHtml(r.site)} <span class="muted">(${escapeHtml(r.state)}, ${escapeHtml(r.country)})</span></span>`).join(" ")}
        ${hits.length > maxShow ? `<span class="pill">+${hits.length - maxShow} more</span>` : ""}
      `;
    }

    // =========================
    // SELF TESTS (non-fatal; logs + banner)
    // =========================
    function runSelfTests() {
      const problems = [];
      const assert = (cond, msg) => { if (!cond) problems.push(msg); };

      assert(Array.isArray(RAW) && RAW.length > 0, "RAW dataset is empty.");
      assert(Array.isArray(ALL) && ALL.length > 0, "No locations loaded after normalization.");
      assert(!!els.country && !!els.state, "Country/state select elements not found in DOM.");
      assert(!!els.results, "Results <tbody> not found in DOM.");

      // Minimal functional sanity checks
      fillCountries();
      fillStates("");
      assert(els.country.options.length >= 1, "Country dropdown did not populate.");
      assert(els.state.options.length >= 1, "State dropdown did not populate.");

      if (problems.length) {
        console.error("Self-tests failed:", problems);
        els.errorBanner.style.display = "block";
        els.errorBanner.textContent = `⚠️ App loaded with ${problems.length} issue(s). Open the console for details.`;
      } else {
        els.errorBanner.style.display = "none";
      }
    }

    // =========================
    // INIT + EVENTS
    // =========================
    els.totalCount.textContent = String(ALL.length);

    // theme init
    let currentTheme = getTheme();
    setTheme(currentTheme);
    els.themeBtn.addEventListener("click", () => {
      currentTheme = nextTheme(currentTheme);
      setTheme(currentTheme);
    });

    // initial render
    fillCountries();
    fillStates("");
    renderAvoid();
    renderResults();
    runSelfTests();

    // filters
    els.country.addEventListener("change", () => {
      fillStates(els.country.value || "");
      els.state.value = "";
      renderResults();
    });

    els.state.addEventListener("change", renderResults);
    els.q.addEventListener("input", renderResults);
    els.exact.addEventListener("change", renderResults);

    els.clear.addEventListener("click", () => {
      els.q.value = "";
      els.country.value = "";
      fillStates("");
      els.state.value = "";
      els.exact.checked = false;
      renderResults();
    });

    // avoid list add
    els.results.addEventListener("click", (e) => {
      const btn = e.target.closest("button");
      if (!btn) return;
      const action = btn.getAttribute("data-action");
      const key = btn.getAttribute("data-key");
      if (action === "avoid" && key) addToAvoidByKey(key);
    });

    // avoid list actions
    els.copy.addEventListener("click", async () => {
      try {
        await navigator.clipboard.writeText(els.avoidText.value);
        els.copy.textContent = "Copied!";
        setTimeout(() => (els.copy.textContent = "Copy"), 900);
      } catch {
        alert("Clipboard copy blocked by your browser. You can still manually select and copy the text.");
      }
    });

    els.download.addEventListener("click", () => {
      download("ghost_adventures_avoid_list.csv", toCSV(avoid));
    });

    els.resetAvoid.addEventListener("click", () => {
      avoid = [];
      renderAvoid();
      renderResults();
    });

    // destination checker
    els.runCheck.addEventListener("click", runDestinationCheck);
    els.check.addEventListener("keydown", (e) => {
      if (e.key === "Enter") runDestinationCheck();
    });
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Base64 Converter Tool</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 800px;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #5e72e4 0%, #825ee4 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1em;
        }

        .tabs {
            display: flex;
            background: #f7f9fc;
            border-bottom: 2px solid #e1e8ed;
        }

        .tab {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            color: #666;
            transition: all 0.3s;
        }

        .tab:hover {
            background: #fff;
        }

        .tab.active {
            background: white;
            color: #5e72e4;
            border-bottom: 3px solid #5e72e4;
            margin-bottom: -2px;
        }

        .content {
            padding: 30px;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .input-group {
            margin-bottom: 25px;
        }

        .input-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #333;
        }

        .textarea-wrapper {
            position: relative;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 15px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
            transition: border-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #5e72e4;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
        }

        button {
            flex: 1;
            padding: 12px 24px;
            background: linear-gradient(135deg, #5e72e4 0%, #825ee4 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(94, 114, 228, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button.secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        button.tertiary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .output-section {
            background: #f7f9fc;
            padding: 20px;
            border-radius: 10px;
            margin-top: 25px;
        }

        .output-section h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .output-content {
            background: white;
            padding: 15px;
            border-radius: 8px;
            min-height: 100px;
            word-wrap: break-word;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            border: 1px solid #e1e8ed;
        }

        .image-preview {
            max-width: 100%;
            border-radius: 8px;
            margin-top: 15px;
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            display: block;
            padding: 15px;
            background: #f7f9fc;
            border: 2px dashed #5e72e4;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .file-input-label:hover {
            background: #fff;
            border-color: #825ee4;
        }

        .error {
            color: #f5576c;
            padding: 10px;
            background: #fef0f0;
            border-radius: 5px;
            margin-top: 10px;
        }

        .success {
            color: #0fa958;
            padding: 10px;
            background: #f0fef5;
            border-radius: 5px;
            margin-top: 10px;
        }

        .char-count {
            position: absolute;
            bottom: 5px;
            right: 10px;
            font-size: 12px;
            color: #999;
        }

        .copy-button {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 5px 10px;
            font-size: 12px;
            background: #5e72e4;
            color: white;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîÑ Base64 Converter</h1>
            <p>Encode and decode text, files, and images</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="switchTab('encode')">Encode to Base64</button>
            <button class="tab" onclick="switchTab('decode')">Decode from Base64</button>
        </div>

        <div class="content">
            <!-- Encode Tab -->
            <div id="encode" class="tab-content active">
                <div class="input-group">
                    <label>Input Type:</label>
                    <div class="button-group">
                        <button onclick="setEncodeMode('text')" id="encode-text-btn">Text</button>
                        <button onclick="setEncodeMode('file')" id="encode-file-btn" class="secondary">File/Image</button>
                    </div>
                </div>

                <div id="encode-text-input" class="input-group">
                    <label>Text to Encode:</label>
                    <div class="textarea-wrapper">
                        <textarea id="encode-text" placeholder="Enter text to convert to Base64..."></textarea>
                        <span class="char-count" id="encode-char-count">0 characters</span>
                    </div>
                </div>

                <div id="encode-file-input" class="input-group" style="display: none;">
                    <label>File to Encode:</label>
                    <div class="file-input-wrapper">
                        <input type="file" id="encode-file" accept="*">
                        <label for="encode-file" class="file-input-label">
                            üìÅ Click to select file or drag and drop
                        </label>
                    </div>
                </div>

                <div class="button-group">
                    <button onclick="encode()">üîê Encode to Base64</button>
                    <button onclick="clearEncode()" class="tertiary">üóëÔ∏è Clear</button>
                </div>

                <div id="encode-output" class="output-section" style="display: none;">
                    <h3>Base64 Output:</h3>
                    <div class="textarea-wrapper">
                        <button class="copy-button" onclick="copyToClipboard('encode-result')">üìã Copy</button>
                        <div id="encode-result" class="output-content"></div>
                    </div>
                </div>
            </div>

            <!-- Decode Tab -->
            <div id="decode" class="tab-content">
                <div class="input-group">
                    <label>Base64 to Decode:</label>
                    <div class="textarea-wrapper">
                        <textarea id="decode-input" placeholder="Paste Base64 string here..."></textarea>
                        <span class="char-count" id="decode-char-count">0 characters</span>
                    </div>
                </div>

                <div class="button-group">
                    <button onclick="decode()">üîì Decode Base64</button>
                    <button onclick="clearDecode()" class="tertiary">üóëÔ∏è Clear</button>
                </div>

                <div id="decode-output" class="output-section" style="display: none;">
                    <h3>Decoded Output:</h3>
                    <div class="textarea-wrapper">
                        <button class="copy-button" onclick="copyToClipboard('decode-result')">üìã Copy</button>
                        <div id="decode-result" class="output-content"></div>
                    </div>
                    <img id="decoded-image" class="image-preview" style="display: none;">
                    <div id="download-section" style="display: none; margin-top: 15px;">
                        <button onclick="downloadDecoded()">üíæ Download File</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentEncodeMode = 'text';
        let decodedBlob = null;
        let decodedFilename = 'decoded_file';

        // Tab switching
        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(tc => tc.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tab).classList.add('active');
        }

        // Encode mode switching
        function setEncodeMode(mode) {
            currentEncodeMode = mode;
            if (mode === 'text') {
                document.getElementById('encode-text-input').style.display = 'block';
                document.getElementById('encode-file-input').style.display = 'none';
                document.getElementById('encode-text-btn').style.background = 'linear-gradient(135deg, #5e72e4 0%, #825ee4 100%)';
                document.getElementById('encode-file-btn').style.background = 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)';
            } else {
                document.getElementById('encode-text-input').style.display = 'none';
                document.getElementById('encode-file-input').style.display = 'block';
                document.getElementById('encode-text-btn').style.background = 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)';
                document.getElementById('encode-file-btn').style.background = 'linear-gradient(135deg, #5e72e4 0%, #825ee4 100%)';
            }
        }

        // Encoding function
        async function encode() {
            const outputSection = document.getElementById('encode-output');
            const resultDiv = document.getElementById('encode-result');
            
            try {
                let base64String = '';
                
                if (currentEncodeMode === 'text') {
                    const text = document.getElementById('encode-text').value;
                    if (!text) {
                        showError('Please enter text to encode');
                        return;
                    }
                    base64String = btoa(unescape(encodeURIComponent(text)));
                } else {
                    const fileInput = document.getElementById('encode-file');
                    if (!fileInput.files[0]) {
                        showError('Please select a file to encode');
                        return;
                    }
                    
                    const file = fileInput.files[0];
                    base64String = await fileToBase64(file);
                }
                
                resultDiv.textContent = base64String;
                outputSection.style.display = 'block';
                showSuccess('Successfully encoded to Base64!');
            } catch (error) {
                showError('Error encoding: ' + error.message);
            }
        }

        // Decoding function
        function decode() {
            const input = document.getElementById('decode-input').value.trim();
            const outputSection = document.getElementById('decode-output');
            const resultDiv = document.getElementById('decode-result');
            const imagePreview = document.getElementById('decoded-image');
            const downloadSection = document.getElementById('download-section');
            
            if (!input) {
                showError('Please enter Base64 to decode');
                return;
            }
            
            try {
                // Check if it's a data URL
                if (input.startsWith('data:')) {
                    const [header, data] = input.split(',');
                    const mimeType = header.match(/data:([^;]+)/)[1];
                    
                    if (mimeType.startsWith('image/')) {
                        // Handle image
                        imagePreview.src = input;
                        imagePreview.style.display = 'block';
                        resultDiv.textContent = 'Image decoded successfully';
                        downloadSection.style.display = 'none';
                    } else {
                        // Handle other file types
                        const binaryString = atob(data);
                        const bytes = new Uint8Array(binaryString.length);
                        for (let i = 0; i < binaryString.length; i++) {
                            bytes[i] = binaryString.charCodeAt(i);
                        }
                        decodedBlob = new Blob([bytes], { type: mimeType });
                        
                        // Try to display as text if possible
                        if (mimeType.startsWith('text/')) {
                            resultDiv.textContent = binaryString;
                        } else {
                            resultDiv.textContent = `File decoded (${mimeType})`;
                        }
                        
                        imagePreview.style.display = 'none';
                        downloadSection.style.display = 'block';
                    }
                } else {
                    // Plain Base64 (assume text)
                    const decoded = decodeURIComponent(escape(atob(input)));
                    resultDiv.textContent = decoded;
                    imagePreview.style.display = 'none';
                    downloadSection.style.display = 'none';
                }
                
                outputSection.style.display = 'block';
                showSuccess('Successfully decoded Base64!');
            } catch (error) {
                // Try to decode as plain Base64
                try {
                    const decoded = atob(input);
                    resultDiv.textContent = decoded;
                    imagePreview.style.display = 'none';
                    downloadSection.style.display = 'none';
                    outputSection.style.display = 'block';
                    showSuccess('Successfully decoded Base64!');
                } catch (e) {
                    showError('Invalid Base64 string');
                }
            }
        }

        // File to Base64 converter
        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // Copy to clipboard
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.textContent;
            
            navigator.clipboard.writeText(text).then(() => {
                showSuccess('Copied to clipboard!');
            }).catch(() => {
                // Fallback for older browsers
                const textarea = document.createElement('textarea');
                textarea.value = text;
                document.body.appendChild(textarea);
                textarea.select();
                document.execCommand('copy');
                document.body.removeChild(textarea);
                showSuccess('Copied to clipboard!');
            });
        }

        // Download decoded file
        function downloadDecoded() {
            if (decodedBlob) {
                const url = URL.createObjectURL(decodedBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = decodedFilename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
        }

        // Clear functions
        function clearEncode() {
            document.getElementById('encode-text').value = '';
            document.getElementById('encode-file').value = '';
            document.getElementById('encode-output').style.display = 'none';
            updateCharCount('encode-text', 'encode-char-count');
        }

        function clearDecode() {
            document.getElementById('decode-input').value = '';
            document.getElementById('decode-output').style.display = 'none';
            updateCharCount('decode-input', 'decode-char-count');
        }

        // Error and success messages
        function showError(message) {
            removeMessages();
            const error = document.createElement('div');
            error.className = 'error';
            error.textContent = '‚ùå ' + message;
            document.querySelector('.content').insertBefore(error, document.querySelector('.content').firstChild);
            setTimeout(removeMessages, 3000);
        }

        function showSuccess(message) {
            removeMessages();
            const success = document.createElement('div');
            success.className = 'success';
            success.textContent = '‚úÖ ' + message;
            document.querySelector('.content').insertBefore(success, document.querySelector('.content').firstChild);
            setTimeout(removeMessages, 3000);
        }

        function removeMessages() {
            document.querySelectorAll('.error, .success').forEach(el => el.remove());
        }

        // Character counter
        function updateCharCount(textareaId, counterId) {
            const textarea = document.getElementById(textareaId);
            const counter = document.getElementById(counterId);
            counter.textContent = textarea.value.length + ' characters';
        }

        // Event listeners
        document.getElementById('encode-text').addEventListener('input', () => {
            updateCharCount('encode-text', 'encode-char-count');
        });

        document.getElementById('decode-input').addEventListener('input', () => {
            updateCharCount('decode-input', 'decode-char-count');
        });

        // File input label update
        document.getElementById('encode-file').addEventListener('change', (e) => {
            const label = e.target.nextElementSibling;
            const fileName = e.target.files[0] ? e.target.files[0].name : 'üìÅ Click to select file or drag and drop';
            label.textContent = fileName;
        });

        // Drag and drop support
        const fileLabel = document.querySelector('.file-input-label');
        
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            fileLabel.addEventListener(eventName, preventDefaults, false);
            document.body.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            fileLabel.addEventListener(eventName, highlight, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            fileLabel.addEventListener(eventName, unhighlight, false);
        });

        function highlight(e) {
            fileLabel.style.background = '#fff';
            fileLabel.style.borderColor = '#825ee4';
        }

        function unhighlight(e) {
            fileLabel.style.background = '#f7f9fc';
            fileLabel.style.borderColor = '#5e72e4';
        }

        fileLabel.addEventListener('drop', handleDrop, false);

        function handleDrop(e) {
            const dt = e.dataTransfer;
            const files = dt.files;
            
            document.getElementById('encode-file').files = files;
            fileLabel.textContent = files[0].name;
        }
    </script>
</body>
</html>

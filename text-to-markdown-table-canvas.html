<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Table Canvas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Best Practice: CSS Variable System for Full Theme Control */
        :root {
            --bg-page: #f8fafc;
            --bg-card: #ffffff;
            --bg-alt: #f1f5f9;
            --text-main: #0f172a;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --accent: #4f46e5;
        }

        .dark-mode {
            --bg-page: #020617; /* Deepest blue/black */
            --bg-card: #0f172a; /* Card blue */
            --bg-alt: #1e293b;  /* Header/Stripe blue */
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --border: #334155;
            --accent: #818cf8;
        }

        body { 
            background-color: var(--bg-page); 
            color: var(--text-main); 
            transition: background-color 0.2s, color 0.2s; 
            font-family: system-ui, -apple-system, sans-serif;
        }

        .card { 
            background-color: var(--bg-card); 
            border: 1px solid var(--border); 
            border-radius: 0.75rem;
            overflow: hidden;
        }

        .card-header { 
            background-color: var(--bg-alt); 
            border-bottom: 1px solid var(--border);
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
        }

        /* Table Preview Sync */
        .preview-table table { border-collapse: collapse; width: 100%; }
        .preview-table th, .preview-table td { border: 1px solid var(--border); padding: 12px; }
        .preview-table th { background-color: var(--bg-alt); }
        .preview-table tr:nth-child(even) { background-color: var(--bg-alt); opacity: 0.6; }

        textarea, input { 
            background: transparent;
            color: inherit;
            font-family: 'ui-monospace', monospace;
            font-size: 0.875rem;
            width: 100%;
            outline: none;
        }

        .btn-toggle { padding: 0.5rem; border-radius: 0.5rem; border: 1px solid var(--border); background: var(--bg-card); }
        .btn-primary { background-color: var(--accent); color: white; padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 600; }
        .btn-secondary { background: var(--bg-card); border: 1px solid var(--border); padding: 0.5rem 1rem; border-radius: 0.5rem; font-weight: 600; }
    </style>
</head>
<body id="app">

    <div class="max-w-6xl mx-auto p-4 md:p-8">
        <header class="flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4">
            <div>
                <h1 class="text-3xl font-black tracking-tight" style="color: var(--accent)">Markdown Table Canvas</h1>
                <p class="text-sm opacity-70">Professional data-to-markdown workbench.</p>
            </div>
            <div class="flex gap-2">
                <button onclick="toggleTheme()" class="btn-toggle" title="Toggle Theme"><span id="themeIcon">ðŸŒ™</span></button>
                <button onclick="clearAll()" class="btn-secondary text-red-500 border-red-200 dark:border-red-900">Clear</button>
                <button onclick="copyMd()" class="btn-secondary">Copy Markdown</button>
                <button onclick="downloadMd()" class="btn-primary">Download .md</button>
            </div>
        </header>

        <div class="card p-4 mb-6 flex flex-col lg:flex-row gap-6 justify-between items-center shadow-sm">
            <div class="flex-1 w-full">
                <label class="text-[10px] font-bold uppercase opacity-50 mb-1 block ml-1">Table Title</label>
                <input type="text" id="title" oninput="update()" placeholder="e.g., Q1 Financial Results" 
                    class="bg-slate-100 dark:bg-slate-900/50 p-2 rounded-lg">
            </div>
            <div class="flex items-center gap-6">
                <div class="flex items-center gap-2">
                    <span class="text-[10px] font-bold uppercase opacity-50">Align:</span>
                    <div class="flex bg-slate-100 dark:bg-slate-900/50 p-1 rounded-lg gap-1">
                        <button onclick="setAlign('left')" id="al-left" class="px-3 py-1 rounded-md text-xs font-bold bg-white dark:bg-slate-700 shadow-sm text-indigo-600">Left</button>
                        <button onclick="setAlign('center')" id="al-center" class="px-3 py-1 rounded-md text-xs font-bold opacity-50">Center</button>
                        <button onclick="setAlign('right')" id="al-right" class="px-3 py-1 rounded-md text-xs font-bold opacity-50">Right</button>
                    </div>
                </div>
                <div id="counter" class="text-[10px] font-bold opacity-40 uppercase">0 Rows | 0 Cols</div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="space-y-6">
                <div class="card">
                    <div class="card-header">1. Raw Input</div>
                    <textarea id="input" class="h-64 p-4" placeholder="Paste Excel/CSV data here..." oninput="update()"></textarea>
                </div>
                <div class="card" style="border:none; background:#020617">
                    <div class="card-header" style="background:#1e293b; color:#94a3b8">2. Markdown Output</div>
                    <textarea id="output" readonly class="h-64 p-4 text-indigo-300" placeholder="Markdown..."></

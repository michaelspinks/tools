<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown Table Canvas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .preview-table table { border-collapse: collapse; width: 100%; }
        .preview-table th, .preview-table td { border: 1px solid #e2e8f0; padding: 10px 14px; }
        body:not(.dark) .preview-table th { background-color: #f1f5f9; color: #334155; }
        body:not(.dark) .preview-table tr:nth-child(even) { background-color: #f8fafc; }
        body.dark .preview-table th, body.dark .preview-table td { border-color: #334155; }
        body.dark .preview-table th { background-color: #1e293b; color: #f1f5f9; }
        body.dark .preview-table tr:nth-child(even) { background-color: #0f172a; }
        .text-left { text-align: left; }
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        textarea, input#tableTitle { font-family: 'Fira Code', monospace; font-size: 0.875rem; }
    </style>
</head>
<body id="appBody" class="bg-slate-50 transition-colors duration-200 min-h-screen p-4 md:p-8 text-slate-900">

    <div class="max-w-6xl mx-auto">
        <header class="flex flex-col md:flex-row md:items-center justify-between mb-8 gap-4 border-b border-slate-200 pb-6 dark:border-slate-700">
            <div>
                <h1 class="text-3xl font-black text-indigo-900 dark:text-indigo-400 tracking-tight">Markdown Table Canvas</h1>
                <p class="text-slate-500 dark:text-slate-400">Professional data-to-markdown workbench.</p>
            </div>
            <div class="flex flex-wrap gap-2">
                <button onclick="toggleTheme()" class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 p-2 rounded-lg shadow-sm hover:bg-slate-50 dark:hover:bg-slate-700 transition">
                    <span id="themeIcon">ðŸŒ™</span>
                </button>
                <button onclick="clearCanvas()" class="bg-white dark:bg-slate-800 border border-red-200 dark:border-red-900 text-red-500 px-4 py-2 rounded-lg font-semibold hover:bg-red-50 dark:hover:bg-red-950 transition shadow-sm text-sm">Clear</button>
                <button onclick="copyToClipboard(this)" class="bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-300 px-4 py-2 rounded-lg font-semibold hover:bg-slate-50 dark:hover:bg-slate-700 transition shadow-sm text-sm">Copy Markdown</button>
                <button onclick="downloadMarkdown()" class="bg-indigo-600 text-white px-4 py-2 rounded-lg font-semibold hover:bg-indigo-700 transition shadow-sm text-sm">Download .md</button>
            </div>
        </header>

        <div class="bg-white dark:bg-slate-800 p-4 mb-6 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm flex flex-col lg:flex-row gap-4 justify-between items-center">
            <div class="w-full lg:w-1/3">
                <label class="block text-[10px] font-bold uppercase text-slate-400 mb-1 ml-1">Table Title</label>
                <input type="text" id="tableTitle" oninput="convertToMarkdown()" placeholder="e.g., Monthly Sales Report" 
                    class="w-full bg-slate-100 dark:bg-slate-900 border-none rounded-lg px-3 py-2 focus:ring-2 focus:ring-indigo-500 outline-none dark:text-slate-200">
            </div>
            
            <div class="flex items-center gap-6">
                <div class="flex items-center gap-3">
                    <span class="text-xs font-bold uppercase text-slate-400">Alignment:</span>
                    <div class="flex bg-slate-100 dark:bg-slate-900 p-1 rounded-lg">
                        <button onclick="setAlignment('left')" id="btn-left" class="align-btn px-4 py-1 rounded-md text-sm font-bold bg-white dark:bg-slate-700 shadow-sm text-indigo-600 dark:text-indigo-300">Left</button>
                        <button onclick="setAlignment('center')" id="btn-center" class="align-btn px-4 py-1 rounded-md text-sm font-bold text-slate-500">Center</button>
                        <button onclick="setAlignment('right')" id="btn-right" class="align-btn px-4 py-1 rounded-md text-sm font-bold text-slate-500">Right</button>
                    </div>
                </div>
                <div id="stats" class="hidden sm:block text-xs font-medium text-slate-400 uppercase tracking-widest">0 Rows | 0 Cols</div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="space-y-6">
                <div class="bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden">
                    <div class="bg-slate-50 dark:bg-slate-900 px-4 py-2 border-b border-slate-200 dark:border-slate-700">
                        <span class="text-xs font-bold uppercase tracking-wider text-slate-400">Input Data</span>
                    </div>
                    <textarea id="input" class="w-full h-56 p-4 outline-none resize-none dark:bg-slate-800 dark:text-slate-200" placeholder="Paste data here..." oninput="convertToMarkdown()"></textarea>
                </div>

                <div class="bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden">
                    <div class="bg-slate-50 dark:bg-slate-900 px-4 py-2 border-b border-slate-200 dark:border-slate-700">
                        <span class="text-xs font-bold uppercase tracking-wider text-slate-400">Markdown Code</span>
                    </div>
                    <textarea id="output" readonly class="w-full h-56 p-4 bg-slate-900 text-indigo-200 outline-none resize-none" placeholder="Markdown..."></textarea>
                </div>
            </div>

            <div class="bg-white dark:bg-slate-800 rounded-xl shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden flex flex-col">
                <div class="bg-slate-50 dark:bg-slate-900 px-4 py-2 border-b border-slate-200 dark:border-slate-700">
                    <span class="text-xs font-bold uppercase tracking-wider text-slate-400">Visual Preview</span>
                </div>
                <div id="preview" class="preview-table overflow-auto p-6 flex-grow min-h-[420px] dark:text-slate-300"></div>
            </div>
        </div>
    </div>

    <script>
        let currentAlign = 'left';

        function toggleTheme() {
            const body = document.getElementById('appBody');
            const isDark = body.classList.toggle('dark');
            document.getElementById('themeIcon').innerText = isDark ? 'â˜€ï¸' : 'ðŸŒ™';
            body.classList.toggle('bg-slate-950', isDark);
            body.classList.toggle('bg-slate-50', !isDark);
        }

        function setAlignment(align) {
            currentAlign = align;
            document.querySelectorAll('.align-btn').forEach(btn => {
                btn.classList.remove('bg-white', 'dark:bg-slate-700', 'shadow-sm', 'text-indigo-600', 'dark:text-indigo-300');
                btn.classList.add('text-slate-500');
            });
            const active = document.getElementById('btn-' + align);
            active.classList.add('bg-white', 'dark:bg-slate-700', 'shadow-sm', 'text-indigo-600', 'dark:text-indigo-300');
            convertToMarkdown();
        }

        function clearCanvas() {
            if (confirm("Clear all?")) {
                document.getElementById('input').value = "";
                document.getElementById('tableTitle').value = "";
                convertToMarkdown();
            }
        }

        function convertToMarkdown() {
            const title = document.getElementById('tableTitle').value.trim();
            const input = document.getElementById('input').value.trim();
            const outputArea = document.getElementById('output');
            const previewArea = document.getElementById('preview');
            const stats = document.getElementById('stats');

            if (!input) {
                outputArea.value = "";
                previewArea.innerHTML = `<div class="h-full flex items-center justify-center text-slate-400 italic">No data</div>`;
                return;
            }

            const rows = input.split('\n').filter(l => l.trim() !== '').map(line => {
                if (line.includes('\t')) return line.split('\t');
                if (line.includes(',')) return line.split(',');
                return line.split(/\s{2,}/); 
            });

            const cleanRows = rows.map(row => row.map(cell => cell.trim()));
            stats.innerText = `${cleanRows.length} Rows | ${cleanRows[0]?.length || 0} Columns`;
            
            // Generate Markdown
            let markdown = title ? `### ${title}\n\n` : "";
            let html = title ? `<h3 class="text-xl font-bold mb-4 dark:text-white">${title}</h3>` : "";
            html += "<table><thead><tr>";

            const sep = currentAlign === 'center' ? ':---:' : (currentAlign === 'right' ? '---:' : '---');

            cleanRows.forEach((row, rowIndex) => {
                markdown += `| ${row.join(' | ')} |\n`;
                if (rowIndex === 0) {
                    markdown += `| ${row.map(() => sep).join(' | ')} |\n`;
                    row.forEach(cell => html += `<th class="text-${currentAlign}">${cell}</th>`);
                    html += "</tr></thead><tbody>";
                } else {
                    html += "<tr>";
                    row.forEach(cell => html += `<td class="text-${currentAlign}">${cell}</td>`);
                    html += "</tr>";
                }
            });

            outputArea.value = markdown;
            previewArea.innerHTML = html + "</tbody></table>";
        }

        function copyToClipboard(btn) {
            const output = document.getElementById('output');
            output.select();
            document.execCommand('copy');
            const old = btn.innerText;
            btn.innerText = "Copied!";
            setTimeout(() => btn.innerText = old, 2000);
        }

        function downloadMarkdown() {
            const content = document.getElementById('output').value;
            if (!content) return;
            const a = document.createElement('a');
            a.href = URL.createObjectURL(new Blob([content], {type:'text/markdown'}));
            a.download = 'table.md'; a.click();
        }

        convertToMarkdown();
    </script>
</body>
</html>
